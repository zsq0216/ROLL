[2026-02-02 05:29:36] [checkpoint_manager.py (79)] [INFO] [actor_train-0 0 / 1][PID 51943] checkpoint_config: {'type': 'file_system', 'output_dir': '/data/cpfs_0/rl_examples/models/toy-0.5B-grpo-code/20260202-052744'}
[2026-02-02 05:29:36] [upload_utils.py (24)] [INFO] [actor_train-0 0 / 1][PID 51943] use FileSystemUploader to upload /data/cpfs_0/rl_examples/models/toy-0.5B-grpo-code/20260202-052744
[2026-02-02 05:29:36] [megatron_strategy.py (72)] [INFO] [actor_train-0 0 / 1][PID 51943] training_args: {'output_dir': './output', 'max_steps': 80, 'num_train_epochs': 1, 'learning_rate': 1e-06, 'lr_scheduler_type': 'linear', 'weight_decay': 0, 'adam_beta1': 0.9, 'adam_beta2': 0.999, 'per_device_train_batch_size': 1, 'gradient_accumulation_steps': 1, 'seed': 42, 'data_seed': None, 'dataloader_num_workers': 0, 'fp16': False, 'bf16': True, 'tf32': None, 'warmup_ratio': 0.0, 'warmup_steps': 1, 'tensor_model_parallel_size': 1, 'pipeline_model_parallel_size': 1, 'expert_model_parallel_size': 1, 'use_distributed_optimizer': False, 'recompute_granularity': 'full', 'max_grad_norm': 1.0}
[2026-02-02 05:29:37] [megatron_strategy.py (1022)] [INFO] [actor_train-0 0 / 1][PID 51943] megatron optimizer: <megatron.core.optimizer.optimizer.Float16OptimizerWithFloat16Params object at 0x717856b67a60>
[2026-02-02 05:29:37] [megatron_strategy.py (1039)] [INFO] [actor_train-0 0 / 1][PID 51943] max steps pipeline 80
[2026-02-02 05:29:37] [megatron_strategy.py (1044)] [INFO] [actor_train-0 0 / 1][PID 51943] max steps worker train 80
[2026-02-02 05:29:37] [megatron_strategy.py (1071)] [INFO] [actor_train-0 0 / 1][PID 51943] [DistributedDataParallel(
  (module): McaGPTModel(
    (embedding): LanguageModelEmbedding(
      (word_embeddings): VocabParallelEmbedding()
      (embedding_dropout): Dropout(p=0.0, inplace=False)
    )
    (rotary_pos_emb): RotaryEmbedding()
    (decoder): TransformerBlock(
      (layers): ModuleList(
        (0-23): 24 x TransformerLayer(
          (input_layernorm): IdentityOp()
          (self_attention): SelfAttention(
            (core_attention): TEDotProductAttention(
              (flash_attention): FlashAttention()
              (fused_attention): FusedAttention()
              (unfused_attention): UnfusedDotProductAttention(
                (scale_mask_softmax): FusedScaleMaskSoftmax()
                (attention_dropout): Dropout(p=0.0, inplace=False)
              )
            )
            (linear_proj): TERowParallelLinear(in_features=896, out_features=896, bias=False, TP=1)
            (linear_qkv): TELayerNormColumnParallelLinear(in_features=896, out_features=1152, bias=True, TP=1)
            (q_layernorm): IdentityOp()
            (k_layernorm): IdentityOp()
          )
          (pre_cross_attn_layernorm): IdentityOp()
          (cross_attention): IdentityOp()
          (cross_attn_bda): IdentityFuncOp()
          (pre_mlp_layernorm): IdentityOp()
          (mlp): MLP(
            (linear_fc1): TELayerNormColumnParallelLinear(in_features=896, out_features=9728, bias=False, TP=1)
            (linear_fc2): TERowParallelLinear(in_features=4864, out_features=896, bias=False, TP=1)
          )
        )
      )
      (final_layernorm): RMSNorm()
    )
    (output_layer): ColumnParallelLinear(in_features=896, out_features=151936, bias=False, TP=1)
  )
)]
[2026-02-02 05:29:38] [base_worker.py (62)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train-0 initialized
[2026-02-02 05:29:40] [strategy.py (149)] [INFO] [actor_train-0 0 / 1][PID 51943] warmup setup_collective_group: model_update_actor_train_0_to_actor_infer_ rank: 0 world_size: 1
[2026-02-02 05:29:40] [context_managers.py (41)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train/model_update_start_offload, memory allocated (GB): 1.9073486328125e-06, memory reserved (GB): 0.001953125, memory max reserved (GB): 0.001953125, rss (GB): 4.390918731689453 memory device used (GB): 2.21429443359375
[2026-02-02 05:29:41] [context_managers.py (41)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train/model_update_start_onload, memory allocated (GB): 0.9202098846435547, memory reserved (GB): 0.939453125, memory max reserved (GB): 0.939453125, rss (GB): 4.390918731689453 memory device used (GB): 3.15179443359375
[2026-02-02 05:32:10] [context_managers.py (41)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train/model_update_end_onload, memory allocated (GB): 1.1702098846435547, memory reserved (GB): 1.173828125, memory max reserved (GB): 1.173828125, rss (GB): 4.641635894775391 memory device used (GB): 5.7724609375
[2026-02-02 05:32:10] [context_managers.py (41)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train/model_update_end_offload, memory allocated (GB): 1.9073486328125e-06, memory reserved (GB): 0.001953125, memory max reserved (GB): 1.173828125, rss (GB): 4.641635894775391 memory device used (GB): 4.6005859375
[2026-02-02 05:32:20] [context_managers.py (41)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train/compute_log_probs_start_offload, memory allocated (GB): 1.9073486328125e-06, memory reserved (GB): 0.001953125, memory max reserved (GB): 0.001953125, rss (GB): 4.643466949462891 memory device used (GB): 2.7490234375
[2026-02-02 05:32:21] [context_managers.py (41)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train/compute_log_probs_start_onload, memory allocated (GB): 0.9202098846435547, memory reserved (GB): 0.939453125, memory max reserved (GB): 0.939453125, rss (GB): 4.643466949462891 memory device used (GB): 3.6865234375
[2026-02-02 05:32:22] [context_managers.py (41)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train/compute_log_probs_end_onload, memory allocated (GB): 0.9325089454650879, memory reserved (GB): 3.12890625, memory max reserved (GB): 3.12890625, rss (GB): 5.147914886474609 memory device used (GB): 5.9521484375
[2026-02-02 05:32:22] [context_managers.py (41)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train/compute_log_probs_end_offload, memory allocated (GB): 0.9325089454650879, memory reserved (GB): 3.12890625, memory max reserved (GB): 3.12890625, rss (GB): 5.148067474365234 memory device used (GB): 5.9521484375
[2026-02-02 05:32:23] [base_worker.py (80)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train-0 generate global step 0
[2026-02-02 05:32:23] [context_managers.py (41)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train/train_step_start_offload, memory allocated (GB): 0.9244828224182129, memory reserved (GB): 0.939453125, memory max reserved (GB): 0.939453125, rss (GB): 5.149593353271484 memory device used (GB): 3.7626953125
[2026-02-02 05:32:24] [context_managers.py (41)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train/train_step_start_onload, memory allocated (GB): 4.604947566986084, memory reserved (GB): 4.630859375, memory max reserved (GB): 4.630859375, rss (GB): 5.149593353271484 memory device used (GB): 7.4541015625
[2026-02-02 05:32:38] [context_managers.py (41)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train/train_step_end_onload, memory allocated (GB): 4.621751308441162, memory reserved (GB): 4.669921875, memory max reserved (GB): 8.814453125, rss (GB): 9.382076263427734 memory device used (GB): 7.6357421875
[2026-02-02 05:32:38] [context_managers.py (41)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train/train_step_end_offload, memory allocated (GB): 4.621751308441162, memory reserved (GB): 4.669921875, memory max reserved (GB): 8.814453125, rss (GB): 9.382076263427734 memory device used (GB): 7.6357421875
[2026-02-02 05:32:39] [context_managers.py (41)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train/model_update_start_offload, memory allocated (GB): 0.003908634185791016, memory reserved (GB): 0.021484375, memory max reserved (GB): 0.021484375, rss (GB): 9.382076263427734 memory device used (GB): 2.9873046875
[2026-02-02 05:32:39] [context_managers.py (41)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train/model_update_start_onload, memory allocated (GB): 0.9241166114807129, memory reserved (GB): 0.939453125, memory max reserved (GB): 0.939453125, rss (GB): 9.382076263427734 memory device used (GB): 3.9052734375
[2026-02-02 05:35:09] [context_managers.py (41)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train/model_update_end_onload, memory allocated (GB): 1.174116611480713, memory reserved (GB): 1.193359375, memory max reserved (GB): 1.193359375, rss (GB): 9.384204864501953 memory device used (GB): 6.1669921875
[2026-02-02 05:35:09] [context_managers.py (41)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train/model_update_end_offload, memory allocated (GB): 0.003908634185791016, memory reserved (GB): 0.021484375, memory max reserved (GB): 1.193359375, rss (GB): 9.384204864501953 memory device used (GB): 4.9951171875
[2026-02-02 05:35:18] [context_managers.py (41)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train/compute_log_probs_start_offload, memory allocated (GB): 0.003908634185791016, memory reserved (GB): 0.021484375, memory max reserved (GB): 0.021484375, rss (GB): 9.385730743408203 memory device used (GB): 2.9873046875
[2026-02-02 05:35:19] [context_managers.py (41)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train/compute_log_probs_start_onload, memory allocated (GB): 0.9241166114807129, memory reserved (GB): 0.939453125, memory max reserved (GB): 0.939453125, rss (GB): 9.385730743408203 memory device used (GB): 3.9052734375
[2026-02-02 05:35:19] [context_managers.py (41)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train/compute_log_probs_end_onload, memory allocated (GB): 0.9325089454650879, memory reserved (GB): 3.12890625, memory max reserved (GB): 3.12890625, rss (GB): 9.385883331298828 memory device used (GB): 6.0947265625
[2026-02-02 05:35:19] [context_managers.py (41)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train/compute_log_probs_end_offload, memory allocated (GB): 0.9325089454650879, memory reserved (GB): 3.12890625, memory max reserved (GB): 3.12890625, rss (GB): 9.385883331298828 memory device used (GB): 6.0947265625
[2026-02-02 05:35:20] [base_worker.py (80)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train-0 generate global step 1
[2026-02-02 05:35:20] [context_managers.py (41)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train/train_step_start_offload, memory allocated (GB): 0.9244828224182129, memory reserved (GB): 0.939453125, memory max reserved (GB): 0.939453125, rss (GB): 9.387256622314453 memory device used (GB): 3.9052734375
[2026-02-02 05:38:14] [base_worker.py (80)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train-0 generate global step 2
[2026-02-02 05:41:08] [base_worker.py (80)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train-0 generate global step 3
[2026-02-02 05:44:02] [base_worker.py (80)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train-0 generate global step 4
[2026-02-02 05:46:58] [base_worker.py (80)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train-0 generate global step 5
[2026-02-02 05:49:54] [base_worker.py (80)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train-0 generate global step 6
[2026-02-02 05:52:50] [base_worker.py (80)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train-0 generate global step 7
[2026-02-02 05:55:49] [base_worker.py (80)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train-0 generate global step 8
[2026-02-02 05:58:46] [base_worker.py (80)] [INFO] [actor_train-0 0 / 1][PID 51943] actor_train-0 generate global step 9
[2026-02-02 05:59:02] [base_worker.py (387)] [INFO] [actor_train-0 0 / 1][PID 51943] save checkpoint-9 to ./output/actor_train-0/checkpoint-9
[2026-02-02 05:59:02] [megatron_strategy.py (1212)] [INFO] [actor_train-0 0 / 1][PID 51943] save_dir: ./output/actor_train-0/checkpoint-9
[2026-02-02 05:59:15] [megatron_strategy.py (1251)] [INFO] [actor_train-0 0 / 1][PID 51943] Saving optimizer state to ./output/actor_train-0/checkpoint-9/iter_0000001/mp_rank_00/optimizer.pt
[2026-02-02 05:59:16] [upload_utils.py (29)] [INFO] [actor_train-0 0 / 1][PID 51943] ./output/actor_train-0/checkpoint-9 save to /data/cpfs_0/rl_examples/models/toy-0.5B-grpo-code/20260202-052744/checkpoint-9, wait...
[2026-02-02 05:59:20] [upload_utils.py (31)] [INFO] [actor_train-0 0 / 1][PID 51943] ./output/actor_train-0/checkpoint-9 save to /data/cpfs_0/rl_examples/models/toy-0.5B-grpo-code/20260202-052744/checkpoint-9, done...
